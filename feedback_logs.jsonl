{"title": "活字格插件开发专家 技能优化建议", "type": "缺陷修复", "scenario": "在编写 ServerCommand 时，发现模板使用的是旧版 SDK 接口 ( IGenerateContext ), 而当前项目引用的是支持异步的新版接口 ( ICommandExecutableInServerSideAsync ).", "pain_point": "导致初次生成的代码编译失败，需要手动修正接口签名和引用。", "suggestion": "建议更新 ServerCommand.cs.txt 模板，默认采用 ICommandExecutableInServerSideAsync 接口，并使用 IServerCommandExecuteContext 作为参数，以适配最新的活字格插件开发标准。", "timestamp": "2026-01-23T10:52:41.405694"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "在编写 KnowledgeBaseCompanionCommand.cs 时，对于 GetDesignerPropertyVisible (用于动态属性) 和 GetDesignerPropertyEditorSettings (用于单元格类型) 的使用场景，文档描述清晰，但在实际编码时容易混淆（尤其是从旧版本迁移或记忆模糊时）。本次任务中我通过查阅文档 Designer_Dynamic_Visibility.md 及时纠正了方法名。", "pain_point": "目前的模板和文档主要侧重于单一功能的实现，对于“服务端命令”中动态属性的高频需求，虽然有文档，但模板 ServerCommand.cs.txt 中未包含 GetDesignerPropertyVisible 的示例代码，导致开发者（或 AI）需要额外查阅文档或手动编写，容易出错。", "suggestion": "建议在 assets/templates/ServerCommand.cs.txt 模板中，默认包含一个注释掉的 GetDesignerPropertyVisible 方法示例，提醒开发者如何实现动态属性可见性。", "timestamp": "2026-01-23T11:15:39.161127"}
{"title": "活字格插件开发专家 技能优化建议", "type": "功能增强", "scenario": "用户希望优化默认 Logo，但 AI 缺乏图像生成能力，只能通过脚本生成简单的几何/文字图形。", "pain_point": "默认 Logo 太丑是高频痛点，但 AI 无法直接提供美观的素材。", "suggestion": "建议在 assets/ 目录下预置几套通用的高质量图标（如数据库、API、工具、文档等主题），供用户在初始化时选择，或者允许 AI 直接调用预置素材替换，而不是现场编写脚本“画”图。", "timestamp": "2026-01-23T12:05:03.298831"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "当需要将原本设计为 Enum 的属性改为支持公式的动态参数时，需要手动修改类型为 object、添加 [FormulaProperty] 属性、移除原有的 Enum 定义（或改为内部校验逻辑），并重新编写解析逻辑。", "pain_point": "目前的模板和文档主要侧重于单一功能的实现，对于“服务端命令”中动态属性的高频需求，虽然有文档，但模板 ServerCommand.cs.txt 中未包含 GetDesignerPropertyVisible 的示例代码，导致开发者（或 AI）需要额外查阅文档或手动编写，容易出错。", "suggestion": "建议在“插件专家”的知识库中增加一个专门的 Refactoring Guide（重构指南），详细列出将静态属性转换为公式属性的标准步骤和 checklist（类型变更、Attribute 添加、解析逻辑、校验逻辑、默认值回退），甚至提供自动化转换脚本", "timestamp": "2026-01-23T12:19:26.978719"}
{"title": "活字格插件开发专家 技能优化建议", "type": "内容缺失", "scenario": "用户在查阅教程时，发现缺少关于插件发布、图标设置、作者信息、版本控制等关键元数据的配置说明。", "pain_point": "开发者完成功能开发后，无法得知如何正确配置插件的发布信息，导致插件在管理控制台中显示信息不全或不规范。", "suggestion": "建议增加“插件发布与元数据配置”相关文档，涵盖 AssemblyInfo.cs 配置（标题、描述、作者、版本）和 [Icon] 特性的使用说明。", "timestamp": "2026-01-23T13:05:19.428743"}
{"title": "活字格插件开发专家 技能优化建议", "type": "功能增强", "scenario": "用户更换开发机器或升级活字格版本后，项目文件中的 DLL 引用路径和调试启动路径失效，需要批量更新。", "pain_point": "目前技能主要聚焦于代码生成和初始化，缺乏对“环境迁移”或“版本升级”场景的自动化支持，开发者需要手动查找或请求 AI 逐个文件替换路径。", "suggestion": "建议在 scripts 目录增加一个 update_references.ps1 脚本或在技能中增加 Migrate-Environment 能力，能够自动扫描 .csproj 和 launchSettings.json ，识别失效的活字格路径并一键更新为当前环境的正确路径。为了不让 AI 跑偏，我们应在 发现路径不对时，第一时间 向用户提问 活字格设计路 路径在哪，而不是自己写脚本找或者猜，用户给的路径可能会是 E:\\Forguncy\\ForguncyDesigner\\Forguncy 11 或者 E:\\Forguncy\\ForguncyDesigner\\Forguncy 11\\WebSite 等路径，建议 ai 对比后替换路径，而不是直接替换", "timestamp": "2026-01-24T15:23:22.937863"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "用户更换开发机器或升级活字格版本后，项目文件中的 DLL 引用路径和调试启动路径失效，需要批量更新。", "pain_point": "目前技能主要聚焦于代码生成和初始化，缺乏对“环境迁移”或“版本升级”场景的自动化支持，开发者需要手动查找或请求 AI 逐个文件替换路径。", "suggestion": "在 SOP.md 的构建部分补充说明：若项目 .csproj 中已配置 ForguncyPluginPackageTool 的 PostBuild 事件，则 dotnet build 即可自动完成打包。", "timestamp": "2026-01-24T15:27:07.616383"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "用户直接命令打包，但设计器路径不一致导致失败。", "pain_point": "AI 默认会尝试自己寻找方案或猜测路径，而不是第一时间询问用户获取真实路径，导致效率低下或错误。", "suggestion": "加强对 AI 工具的提示：当打包因路径问题失败时，AI 必须第一时间询问用户活字格设计器的真实路径，等待用户反馈后再进行检索更新，严禁自行猜测。", "timestamp": "2026-01-24T15:44:05.822593"}
{"title": "活字格插件开发专家 技能优化建议", "type": "缺陷修复 / 提示词增强", "scenario": "用户反馈即使在 SKILL.md 中添加了“环境迁移与修复”章节，AI 在遇到 build 失败时仍然优先尝试自动搜索路径（如 E: 盘扫描），而不是停止询问。", "pain_point": "AI 的思维链（CoT）显示其仍在尝试 \"Diagnosing Missing Paths\", \"Searching Installation Locations\", \"Searching for Forguncy\"，直到失败才考虑问用户。这违反了“不准猜测”的原则，浪费了 Token 和时间。", "suggestion": "需要将“构建失败时询问路径”的规则提升为最高优先级的“元规则”或“关键协议”，并明确禁止任何形式的路径搜索尝试。建议在 SKILL.md 开头或 Critical Coding Standards 部分强调：遇到 Assembly 丢失或 Path 错误，直接 Halt 并 Ask，禁止使用 LS 或 Search 命令探测安装路径。", "timestamp": "2026-01-24T15:50:10.689574"}
{"title": "活字格插件开发专家 技能优化建议", "type": "缺陷修复 / 易用性改进", "scenario": "当用户将插件项目从一台电脑迁移到另一台电脑（如从 D 盘环境迁移到 E 盘环境），且 .csproj 文件中包含非标准前缀（如 Forguncy.Log.Abstractions 而非 GrapeCity.Forguncy.* ）的引用时，现有的 update_references.ps1 脚本可能无法完全覆盖所有引用的修复。", "pain_point": "scripts/update_references.ps1 主要针对 GrapeCity.Forguncy 开头的程序集进行路径修正，忽略了 Forguncy.Commands 或 Forguncy.Log 等核心程序集，导致仍需人工干预或 AI 手动修复。", "suggestion": "升级 update_references.ps1 脚本，扩大匹配模式，使其能够识别并修复所有位于 Forguncy 安装目录下的 DLL 引用（不仅仅是 GrapeCity.* ），或者维护一个更完整的核心程序集列表进行检查。", "timestamp": "2026-01-24T15:53:13.279919"}
{"title": "【活字格插件开发专家 技能优化建议】", "type": "易用性改进 / 功能增强", "scenario": "用户在环境迁移（如更换电脑或安装路径变更）后，csproj 文件中的引用路径失效，导致打包失败。本次案例中，除了标准的 Website\\bin ，还涉及到了 Website\\designerBin 下的 DLL 引用。", "pain_point": "现有的 update_references.ps1 脚本主要关注 Website\\bin 目录下的 ServerApi 等核心库，未能自动检测并修复 designerBin 目录下的设计时组件（如 GrapeCity.Forguncy.CellTypes.Design.dll ），导致仍需人工介入或二次修改。", "suggestion": "建议升级 scripts/update_references.ps1 脚本，增加对 designerBin 目录的扫描逻辑。当在 Website\\bin 中找不到目标 DLL 时，自动尝试在同级的 designerBin 目录中查找，从而实现一键完全修复。", "timestamp": "2026-01-24T16:05:30.004492"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "用户在维护现有代码或进行接口迁移时，发现 SOP 缺乏针对性的指导。", "pain_point": "现有的 SOP 流程主要针对“项目初始化”和“新功能开发”，对于“维护现有代码”或“接口迁移”类的轻量级任务，缺乏针对性的精简流程指导（如如何快速定位关键代码并进行最小化修改）。", "suggestion": "建议在 SOP 中增加“代码维护与重构”章节，提供针对“API 升级/迁移”场景的操作指引，例如推荐先使用 grep/search 定位旧接口引用，再进行针对性替换和验证。", "timestamp": "2026-01-26T14:14:47.901629"}
{"title": "活字格插件开发专家 技能优化建议", "type": "功能增强", "scenario": "在面对“拆分聚合命令”这种结构性重构时，需要手动规划基类、迁移枚举、分发逻辑，步骤繁琐且容易遗漏。", "pain_point": "目前的 AI 辅助主要针对单个文件的生成或修改，对于复杂的结构性重构（如拆分聚合命令）缺乏系统化的 SOP 或自动化流程。", "suggestion": "增加“Refactor to Multiple Commands”指南，包含：1. 自动分析 switch-case 结构；2. 提取公共属性生成基类；3. 拆分为独立子类；4. 迁移共享 Enum 或辅助类。", "timestamp": "2026-01-26T14:15:00.000000"}
{"suggestion":"�� Integration_Lifecycle.md ������ȫ����Դ�����½ڣ���ȷ destroy() �ı�Ҫ�ԡ��� CellType.js.txt ģ����Ԥ�� destroy() ����������ʾ����","pain_point":"����������ʹ�� jQuery remove �¼��ȷǳ����ֶΣ����Ǳ�׼�� destroy() �������ڣ������ڴ�й©��������Ϊ��","timestamp":"2026-01-29T14:46:38.544937","type":"�����ԸĽ�","scenario":"�ڴ������������ȫ���¼����� window.onresize��ʱ����Ҫ������Դ������","title":"���ָ�������ר�� �����Ż�����"}
{"suggestion":"�� SDK_BestPractices.md �����ӹ淶���κη� null/false Ĭ��ֵ�����ԣ������ǲ���ֵ��Ϊ true ʱ����������ʽ��ע [DefaultValue] ���ԡ�","pain_point":"������ʽ��ע [DefaultValue]�����ָ�����������޷���ȷ���������Ϊ��Ĭ��ֵ���� False����״̬���������ö�ʧ��","timestamp":"2026-01-29T14:51:21.673439","type":"���վ�ʾ","scenario":"�� C# ���Ե�Ĭ��ֵ��Ϊ false �� null ʱ���� bool Ĭ��Ϊ true����","title":"���ָ�������ר�� �����Ż�����"}
{"suggestion":"在 SDK_BestPractices.md 中增加规范：任何非 null/false 默认值的属性（尤其是布尔值设为 true 时），必须显式标注 [DefaultValue] 特性。","pain_point":"若不显式标注 [DefaultValue]，活字格设计器可能无法正确保存该属性为非默认值（如 False）的状态，导致配置丢失。","timestamp":"2026-01-29T14:51:21.673439","type":"风险警示","scenario":"当 C# 属性的默认值不为 false 或 null 时（如 bool 默认为 true）。","title":"活字格插件开发专家 技能优化建议"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "开发者反馈插件渲染结果不符合预期（如空白），但缺乏运行时信息。", "pain_point": "前端 JS 报错往往被框架捕获或淹没在海量日志中。如果没有针对性的 console.log ，开发者很难判断是数据未获取、“容器无尺寸还是配置解析失败。", "suggestion": "在插件模板中默认包含一套埋点逻辑。建议在 render 方法的入口、数据处理后、渲染结束这三个节点预设带前缀（如 [PluginName]: ）的日志输出。", "timestamp": "2026-01-29T15:05:00.000000"}
{"title": "活字格插件开发专家 技能优化建议", "type": "风险警示 / 易用性改进", "scenario": "插件在 createContent 阶段尝试获取 DOM 尺寸进行初始化。", "pain_point": "活字格的 DOM 挂载是异步的，直接在 createContent 中同步获取尺寸极其不稳定，经常返回 0，导致图表或第三方库初始化失败。", "suggestion": "在最佳实践中强制推荐尺寸检测轮询模式。增加 waitForSize 辅助函数，确保在 DOM 真正拥有尺寸后再执行初始化逻辑。", "timestamp": "2026-01-29T15:10:00.000000"}
{"title": "活字格插件开发专家 技能优化建议", "type": "风险警示 / 易用性改进", "scenario": "开发者在编写插件时，由于内部涉及异步调用（如 evaluateFormulaAsync ），容易误将生命周期方法声明为 async 。", "pain_point": "活字格底层不处理生命周期返回的 Promise，导致静默失败（无报错但无显示），排查成本高。", "suggestion": "在插件开发模板或技能说明中明确标注：createContent 严禁使用 async 关键字，必须同步返回 DOM 元素。", "timestamp": "2026-01-29T15:27:00.000000"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "在配置复杂的嵌套属性（如 TrackConfigs -> Plots ）时，设计器端的属性说明对用户理解 JSON 数据结构至关重要。", "pain_point": "默认生成的 C# 属性说明往往过于简略，用户不知道数据源应该是什么格式。", "suggestion": "在生成 CellType 模板时，建议在 [Description] 中包含示例数据结构的描述（例如： [{ \"depth\": 100, \"val\": 1 }] ），这能极大降低插件使用者的上手难度。", "timestamp": "2026-01-29T17:24:00.000000"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "用户在提示 INamedObject 使用方式时，给出了具体的代码模式，强调需要手动实现接口属性。", "pain_point": "现有文档虽然提到了 INamedObject ，但对于是否需要显式定义 Name 属性以及如何与 ObjectPropertyBase 配合使用，可能不够直观，容易让开发者产生疑惑。", "suggestion": "建议在 ObjectListProperty 的相关文档中，明确指出实现 INamedObject 接口时，必须在类中定义 public string Name { get; set; } 属性，并给出包含 ObjectPropertyBase 继承的完整示例代码", "timestamp": "2026-01-29T17:58:00.000000"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "当用户从一个环境迁移到另一个环境（如更换电脑或升级活字格版本）时， .csproj 中的 Reference 路径和 launchSettings.json 中的 executablePath 往往会失效，导致构建报错。", "pain_point": "AI 无法自动感知用户的本地安装路径，且手动一个个修改 .csproj 中的多个引用路径非常繁琐且容易出错。", "suggestion": "文档/逻辑优化: 在技能说明中增加一个“环境修复协议”：当检测到引用丢失或路径错误时，AI 应主动引导用户提供其设计器路径，并提供一个一键更新脚本（类似 update_references.ps1 ）来批量替换项目中所有的硬编码路径。", "timestamp": "2026-01-29T21:01:13.731396"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进", "scenario": "当 C# 枚举类型发生变化时，需要手动同步更新 JS 中的 switch-case 分支（通常是 0, 1, 2... 数字）。", "pain_point": "活字格插件开发中，C# 枚举在 JS 侧以数字形式体现，开发者容易记错对应关系（例如 C# 加了一个项，导致 JS 侧的数字序号全部偏移），且代码可读性差。", "suggestion": "在生成的插件模板中，建议在 JS 侧自动定义一个对应的 Enum 对象（例如 const TrackType = { Scale: 0, Graph: 1, ... } ），并在 switch 语句中使用该对象，以提高代码的健壮性和可读性。本次开发中我手动维护了这种对应关系。", "timestamp": "2026-01-30T09:29:00.000000"}
{"title": "活字格插件开发专家 技能优化建议", "type": "功能增强", "scenario": "手动在 C# 定义属性并同步到 JS 逻辑中比较繁琐，且容易出现命名不一致导致配置失效。", "pain_point": "手动在 C# 定义属性并同步到 JS 逻辑中比较繁琐，且容易出现命名不一致导致配置失效。", "suggestion": "文档/逻辑优化: 建议提供一个配置同步模板，例如在 JS 侧使用一个通用的 applyGlobalConfigs(viewer, cellParam) 函数来自动化处理这些标准的外观属性同步，减少重复的 if/else 或三元运算符判断逻辑。", "timestamp": "2026-01-30T10:02:44.837915"}
{"title": "活字格插件开发专家 技能优化建议", "type": "易用性改进 / 风险警示", "scenario": "AI 面对默认开启且支持取消勾选的需求时，发现 Forguncy 的序列化优化机制（值为 false 时省略 Key）与 JS 端读取默认值存在冲突。", "pain_point": "1. 如果 C# 和 JS 都设默认值为 true ，则无法隐藏（因为隐藏时无 Key，JS 会回退到 true ）。\n2. 如果 C# 和 JS 都设默认值为 false ，则不符合默认开启的产品需求。", "suggestion": "沉淀默认开启标准模式 ：在技能说明中增加默认开启的布尔属性实现方案”。明确规范：C# 属性赋初值为 true ，但 DefaultValue 标为 false ；同时 JS 端读取默认值设为 false 。避免过度依赖分析器 ：AI 应能识别编译警告中的假阳性。在本例中，虽然分析器建议 DefaultValue 与初值保持一致，但为了业务逻辑闭环，这种不一致是必要的 Hack。", "timestamp": "2026-01-30T14:37:41.474297"}
{"title": "重构打包逻辑以支持 npm link", "type": "需求/场景类", "scenario": "我们需要构建一个 build 目录，里面放置最新的 skill 文档，后续我会通过 npm link 方式完成项目对 build 路径的引用", "pain_point": "现有打包逻辑仅生成 .skill 文件，无法满足通过 npm link 引用构建产物的需求。", "suggestion": "重构打包逻辑，构建一个 build 目录，其中包含最新的 skill 文档。", "timestamp": "2026-01-31T16:05:23.522479"}
{"title": "使用 package.json 替代 VERSION 文件", "type": "需求/场景类", "scenario": "在 Skill 根目录引入 package.json 管理版本号，替代原有的 VERSION 文件", "pain_point": "VERSION 文件是非标准做法，使用 package.json 更符合 Node.js 生态习惯，且方便 npm 管理。", "suggestion": "在根目录创建 package.json，迁移版本号，并修改打包逻辑以从中读取配置。", "timestamp": "2026-01-31T16:10:34.198775"}
{"title": "HintPath 路径错误与更新脚本缺失问题", "type": "缺陷修复 / 易用性改进", "scenario": "用户在迁移环境或构建项目时，发现 .csproj 中的 Reference HintPath 仅指向目录而非具体 DLL，导致构建失败。且提到的修复脚本实际不存在或不可用。", "pain_point": "1. scripts/update_references.ps1 在项目中缺失（虽然我刚检查发现存在，可能是用户版本滞后或文档误导，需确认）。\n2. HintPath 必须指向 DLL 文件，仅指向目录无效。\n3. 手动修改繁琐且易错。", "suggestion": "1. 完善/提供 update_references.ps1，确保自动将 HintPath 更新为指向具体的 DLL 文件。\n2. 更新环境修复协议文档。", "timestamp": "2026-01-31T16:51:28.844029"}
{"scenario": "?????????????? Command ?? CellType ????????????????????", "title": "CellType ? Command ??????", "pain_point": "1. ?? CellType ???????2. ???????????3. Command ???? TargetCell ???????", "suggestion": "1. CellType ???? onCommand/update ???2. ?????????????3. Command ??????????", "type": "????", "timestamp": "2026-01-31T17:48:54.334621"}
{"scenario": "开发者在删除插件组件（如 Command 或 CellType）后，常遗漏更新 PluginConfig.json，导致运行时错误。", "title": "PluginConfig.json 引用一致性风险警示", "pain_point": "1. dotnet build 无法校验配置文件。2. 配置错误仅在运行时发现。3. 缺乏删除后的自动关联检查机制。", "suggestion": "1. 增加自动化校验工具检查 PluginConfig.json 与代码的一致性。2. 在技能说明中增加删除操作后的防御性提醒。", "type": "风险警示/流程优化", "timestamp": "2026-01-31T18:04:01.704348"}
{"title": "API 设计参数最小化与上下文感知优化", "type": "易用性改进", "scenario": "开发者在设计插件 API 时暴露过多技术细节参数，导致用户使用门槛高且易出错。", "pain_point": "1. 用户需要理解内部技术实现。2. 参数冗余导致配置复杂。3. 容易出现参数组合冲突。", "suggestion": "1. RunTimeMethod 增加智能参数推断模式。2. SOP.md 增加 API 设计原则。", "timestamp": "2026-01-31T18:26:26.643855"}
{"title": "第三方库集成的数据转换一致性优化", "type": "易用性改进", "scenario": "在集成第三方库时，AI 容易忽略初始化时的 mapping 逻辑，导致 setData 时直接传递原始 JSON 而更新失败。例如 videx-wellog 轨道创建时定义了转换函数，但更新时可能未复用。", "pain_point": "数据处理管道在初始化和更新时不一致，导致运行时错误且难以排查。", "suggestion": "1. 提取转换逻辑为独立的纯函数。2. SOP.md 增加数据管道检查原则。3. CellType 模板增加转换函数示例。", "timestamp": "2026-01-31T18:37:10.337973"}
{"title": "预设配置 (Preset) 模式易用性优化", "type": "易用性改进", "scenario": "复杂组件（如多曲线轨道）需要嵌套配置（Track -> Plots -> Curves），业务人员手动构建既繁琐又易出错。", "pain_point": "配置项缺乏业务语义，用户难以理解底层技术参数的组合关系。", "suggestion": "1. 推广“预设配置（Preset）”模式。2. 在设计中提供基于业务场景的高级选项（如 Lithology Track）。3. 在代码层面将高级选项展开为原子配置组合。", "timestamp": "2026-01-31T18:49:49.205895"}
{"title": "默认值管理一致性优化", "type": "易用性改进", "scenario": "默认值管理分散在 C# 构造函数和 JS 的 _getDefaultTrackConfigs 中，容易导致不一致（如本次就需要两边修改）。", "pain_point": "两端硬编码默认值导致维护成本翻倍，且极易出现版本失配或逻辑漏洞。", "suggestion": "1. 引入“配置共享机制”。2. 将默认配置抽取为独立资源或常量。3. 推荐 C# 初始化时序列化默认配置并通过 PluginConfig 传递给前端作为兜底。", "timestamp": "2026-01-31T18:56:54.069219"}
